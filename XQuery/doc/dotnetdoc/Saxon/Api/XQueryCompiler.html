<!DOCTYPE HTML><html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>XQueryCompiler</title>
      <meta name="keywords" content="Saxon.Api.XQueryCompiler class">
      <link rel="stylesheet" type="text/css" href="../../saxon-dotnetdoc.css" title="Style">
   </head>
   <body>
      <div class="contents">
         <h3><a href="../../index.html" class="home">Saxon.Api</a></h3>
         <ul class="list">
            <li><a href="CollectionFinder.html">CollectionFinder</a></li>
            <li><a href="DocumentBuilder.html">DocumentBuilder</a></li>
            <li><a href="DomDestination.html">DomDestination</a></li>
            <li><a href="DynamicContext.html">DynamicContext</a></li>
            <li><a href="Error.html">Error</a></li>
            <li><a href="ErrorReporter.html">ErrorReporter</a></li>
            <li><a href="ExtensionFunctionCall.html">ExtensionFunctionCall</a></li>
            <li><a href="ExtensionFunctionDefinition.html">ExtensionFunctionDefinition</a></li>
            <li><a href="Feature.html">Feature</a></li>
            <li><a href="FeatureKeys.html">FeatureKeys</a></li>
            <li><a href="HostLanguage.html">HostLanguage</a></li>
            <li><a href="IDestination.html">IDestination</a></li>
            <li><a href="IInvalidityHandler.html">IInvalidityHandler</a></li>
            <li><a href="IResource.html">IResource</a></li>
            <li><a href="JsonBuilder.html">JsonBuilder</a></li>
            <li><a href="Location.html">Location</a></li>
            <li><a href="Message.html">Message</a></li>
            <li><a href="NamespaceConstant.html">NamespaceConstant</a></li>
            <li><a href="NodeResource.html">NodeResource</a></li>
            <li><a href="NullDestination.html">NullDestination</a></li>
            <li><a href="ParameterDetails.html">ParameterDetails</a></li>
            <li><a href="Predicates.html">Predicates</a></li>
            <li><a href="Processor.html">Processor</a></li>
            <li><a href="QName.html">QName</a></li>
            <li><a href="RawDestination.html">RawDestination</a></li>
            <li><a href="ResourceRequest.html">ResourceRequest</a></li>
            <li><a href="ResourceResolver.html">ResourceResolver</a></li>
            <li><a href="ResultDocumentHandler.html">ResultDocumentHandler</a></li>
            <li><a href="SaxonApiException.html">SaxonApiException</a></li>
            <li><a href="SchemaManager.html">SchemaManager</a></li>
            <li><a href="SchemaResolver.html">SchemaResolver</a></li>
            <li><a href="SchemaValidationMode.html">SchemaValidationMode</a></li>
            <li><a href="SchemaValidator.html">SchemaValidator</a></li>
            <li><a href="Serializer.html">Serializer</a></li>
            <li><a href="StaticContext.html">StaticContext</a></li>
            <li><a href="Step.html">Step&lt;TInput, TResult&gt;</a></li>
            <li><a href="Steps.html">Steps</a></li>
            <li><a href="TextResource.html">TextResource</a></li>
            <li><a href="TreeModel.html">TreeModel</a></li>
            <li><a href="UnprefixedElementMatchingPolicy.html">UnprefixedElementMatchingPolicy</a></li>
            <li><a href="ValidationFailure.html">ValidationFailure</a></li>
            <li><a href="WhitespacePolicy.html">WhitespacePolicy</a></li>
            <li><a href="XdmAnyArrayType.html">XdmAnyArrayType</a></li>
            <li><a href="XdmAnyFunctionType.html">XdmAnyFunctionType</a></li>
            <li><a href="XdmAnyItemType.html">XdmAnyItemType</a></li>
            <li><a href="XdmAnyMapType.html">XdmAnyMapType</a></li>
            <li><a href="XdmAnyNodeType.html">XdmAnyNodeType</a></li>
            <li><a href="XdmArray.html">XdmArray</a></li>
            <li><a href="XdmAtomicType.html">XdmAtomicType</a></li>
            <li><a href="XdmAtomicValue.html">XdmAtomicValue</a></li>
            <li><a href="XdmAxis.html">XdmAxis</a></li>
            <li><a href="XdmDestination.html">XdmDestination</a></li>
            <li><a href="XdmEmptySequence.html">XdmEmptySequence</a></li>
            <li><a href="XdmExternalObject.html">XdmExternalObject</a></li>
            <li><a href="XdmFunctionItem.html">XdmFunctionItem</a></li>
            <li><a href="XdmItem.html">XdmItem</a></li>
            <li><a href="XdmItemType.html">XdmItemType</a></li>
            <li><a href="XdmMap.html">XdmMap</a></li>
            <li><a href="XdmNode.html">XdmNode</a></li>
            <li><a href="XdmNodeKind.html">XdmNodeKind</a></li>
            <li><a href="XdmSequenceType.html">XdmSequenceType</a></li>
            <li><a href="XdmValue.html">XdmValue</a></li>
            <li><a href="XmlReaderResource.html">XmlReaderResource</a></li>
            <li><a href="XmlWriterDestination.html">XmlWriterDestination</a></li>
            <li><a href="XPathCompiler.html">XPathCompiler</a></li>
            <li><a href="XPathExecutable.html">XPathExecutable</a></li>
            <li><a href="XPathSelector.html">XPathSelector</a></li>
            <li><a href="XQueryCompiler.html">XQueryCompiler</a></li>
            <li><a href="XQueryEvaluator.html">XQueryEvaluator</a></li>
            <li><a href="XQueryExecutable.html">XQueryExecutable</a></li>
            <li><a href="XQueryResolver.html">XQueryResolver</a></li>
            <li><a href="Xslt30Transformer.html">Xslt30Transformer</a></li>
            <li><a href="XsltCompiler.html">XsltCompiler</a></li>
            <li><a href="XsltExecutable.html">XsltExecutable</a></li>
            <li><a href="XsltPackage.html">XsltPackage</a></li>
            <li><a href="XsltTransformer.html">XsltTransformer</a></li>
         </ul>
         <p>&nbsp;</p>
      </div>
      <div class="margin">
         &nbsp;
         </div>
      <div class="main">
         <h3>Saxon.Api</h3>
         <h1><span class="classLabel">Class&nbsp;</span>XQueryCompiler</h1>
         <hr>
         <dl>
            <dt>
               <div class="code">public class&nbsp;XQueryCompiler</div>
            </dt>
         </dl>
         <p>
            The <code>XQueryCompiler</code> object allows XQuery queries to be compiled.
            </p>
         
         <p>To construct an <code>XQueryCompiler</code>, use the factory method
            <code>NewXQueryCompiler</code> on the <a href="XQueryCompiler.html#Processor" class="apilink">XQueryCompiler.Processor</a> object.</p>
         
         <p>The <code>XQueryCompiler</code> holds information that represents the static context
            for the queries that it compiles. This information remains intact after performing
            a compilation. An <code>XQueryCompiler</code> may therefore be used repeatedly to compile multiple
            queries. Any changes made to the <code>XQueryCompiler</code> (that is, to the
            static context) do not affect queries that have already been compiled.</p>
         
         <p>An <code>XQueryCompiler</code> may be used concurrently in multiple threads, but
            it should not then be modified once initialized.</p>
         <a name="property_summary"></a><table>
            <tr class="TableHeading">
               <th colspan="2">
                  <h3>Property Summary</h3>
               </th>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.uri(VS.80).aspx" class="apilink system" target="_blank">Uri</a></td>
               <td><span class="signature"><a href="#BaseUri" class="apilink">BaseUri</a></span><div class="fnormal">
                     <p>
                        The base URI of the query, which forms part of the static context
                        of the query. This is used for resolving any relative URIs appearing
                        within the query, for example in references to library modules, schema
                        locations, or as an argument to the <code>doc()</code> function.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a></td>
               <td><span class="signature"><a href="#CompileWithTracing" class="apilink">CompileWithTracing</a></span><div class="fnormal">
                     <p>
                        Property indicating that the query is to be compiled with tracing enabled.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="XdmItemType.html" class="apilink">XdmItemType</a></td>
               <td><span class="signature"><a href="#ContextItemType" class="apilink">ContextItemType</a></span><div class="fnormal">
                     <p>
                        The required context item type for the expression. This is used for
                        optimizing the expression at compile time, and to check at run-time
                        that the value supplied for the context item is the correct type.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a></td>
               <td><span class="signature"><a href="#DefaultCollationName" class="apilink">DefaultCollationName</a></span><div class="fnormal">
                     <p>
                        The name of the default collation used by queries compiled using this <code>XQueryCompiler</code>.
                        This must be the name of a collation that is known to the <code>Processor</code>.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="ErrorReporter.html" class="apilink">ErrorReporter</a></td>
               <td><span class="signature"><a href="#ErrorReporter" class="apilink">ErrorReporter</a></span><div class="fnormal">
                     <p>Set the <code>ErrorReporter</code> to be used when validating instance documents as a user defined IErrorReporter.
                        Requirements here is IErrorReport implementation with a user-written <code>report()</code> method, it is possible to
                        intercept error conditions as they occur.
                        If this property is used then the ErrorList property and SetErrorList method is overriden.</p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a></td>
               <td><span class="signature"><a href="#FastCompilation" class="apilink">FastCompilation</a></span><div class="fnormal">
                     <p>
                        Property indicating that fast compilation is preferred.
                        Fast compilation will generally be achieved at the expense of run-time performance
                        and quality of diagnostics. Fast compilation is a good trade-off if (a) the expression
                        is known to be correct,
                        and (b) once compiled, the expression is only executed once against a document of
                        modest size.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="Processor.html" class="apilink">Processor</a></td>
               <td><span class="signature"><a href="#Processor" class="apilink">Processor</a></span><div class="fnormal">
                     <p>
                        Get the <code>Processor</code> from which this <code>XQueryCompiler</code> was constructed
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a></td>
               <td><span class="signature"><a href="#SchemaAware" class="apilink">SchemaAware</a></span><div class="fnormal">
                     <p>
                        Property indicating that the query is to be compiled to be schema-aware, even if it
                        contains no
                        "import schema" declarations. Normally a query is treated as schema-aware
                        only if it contains one or more "import schema" declarations. 
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a></td>
               <td><span class="signature"><a href="#StreamingEnabled" class="apilink">StreamingEnabled</a></span><div class="fnormal">
                     <p>
                        Property indicating that the query is to be compiled to enable streaming, which is
                        necessary if the query is to be executed using the method <code>XQueryEvaluator.RunStreamed()</code>.
                        In streaming mode, the source document is supplied as a stream, and no tree is built
                        in memory. The default is false.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a></td>
               <td><span class="signature"><a href="#UpdatingEnabled" class="apilink">UpdatingEnabled</a></span><div class="fnormal">
                     <p>
                        This property indicates whether XQuery Update syntax is accepted. The default
                        value is false. This property must be set to true before compiling a query that
                        uses update syntax.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a></td>
               <td><span class="signature"><a href="#XQueryLanguageVersion" class="apilink">XQueryLanguageVersion</a></span><div class="fnormal">
                     <p>
                        This property indicates which version of XQuery language syntax is accepted. The values
                        accepted are "3.1" and "4.0". The default is "3.1".
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="XQueryResolver.html" class="apilink">XQueryResolver</a></td>
               <td><span class="signature"><a href="#XQueryResolver" class="apilink">XQueryResolver</a></span><div class="fnormal">
                     <p>
                        A user-supplied <code>XQueryResolver</code> used to resolve the URIs appearing in an
                        <code>import module</code> declaration.
                        </p>
                  </div>
               </td>
            </tr>
         </table>
         <p>&nbsp;</p><a name="method_summary"></a><table>
            <tr class="TableHeading">
               <th colspan="2">
                  <h3>Method Summary</h3>
               </th>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="XQueryExecutable.html" class="apilink">XQueryExecutable</a></td>
               <td><span class="signature"><a href="#Compile(Stream)" class="apilink">Compile</a> (<a href="http://msdn.microsoft.com/en-us/library/system.io.stream(VS.80).aspx" class="apilink system" target="_blank">Stream</a>&nbsp;query)</span><div class="fnormal">
                     <p>
                        Compile a query supplied as a <code>Stream</code>.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;<a href="XQueryExecutable.html" class="apilink">XQueryExecutable</a></td>
               <td><span class="signature"><a href="#Compile(string)" class="apilink">Compile</a> (<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;query)</span><div class="fnormal">
                     <p>
                        Compile a query supplied as a <code>string</code>.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;void</td>
               <td><span class="signature"><a href="#CompileLibrary(Stream)" class="apilink">CompileLibrary</a> (<a href="http://msdn.microsoft.com/en-us/library/system.io.stream(VS.80).aspx" class="apilink system" target="_blank">Stream</a>&nbsp;query)</span><div class="fnormal">
                     <p>
                        Compile a library module supplied as a stream. The code generated by compiling the
                        library is available
                        for importing by all subsequent compilations using the same XQueryCompiler; it is
                        identified by an
                        "import module" declaration that specifies the module URI of the library module. No
                        module location
                        hint is required, and if one is present, it is ignored.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;void</td>
               <td><span class="signature"><a href="#CompileLibrary(string)" class="apilink">CompileLibrary</a> (<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;query)</span><div class="fnormal">
                     <p>
                        Compile a library module supplied as a string. The code generated by compiling the
                        library is available
                        for importing by all subsequent compilations using the same XQueryCompiler; it is
                        identified by an
                        "import module" declaration that specifies the module URI of the library module. No
                        module location
                        hint is required, and if one is present, it is ignored.
                        </p>
                  </div>
               </td>
            </tr>
            <tr class="TableRow">
               <td class="col1">&nbsp;void</td>
               <td><span class="signature"><a href="#DeclareNamespace(string,string)" class="apilink">DeclareNamespace</a> (<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;prefix, <a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;uri)</span><div class="fnormal">
                     <p>
                        Declare a namespace for use by the query. This has the same
                        status as a namespace declaration appearing within the query prolog (though
                        a declaration of the same prefix in the query prolog will take
                        precedence).
                        </p>
                  </div>
               </td>
            </tr>
         </table>
         <p>&nbsp;</p><a name="property_detail"></a><div class="section">
            <h2>Property Detail</h2><a name="BaseUri"></a><div class="member">
               <h3>BaseUri</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.uri(VS.80).aspx" class="apilink system" target="_blank">Uri</a>&nbsp;BaseUri&nbsp;{get; set; }</div>
               <p>
                  The base URI of the query, which forms part of the static context
                  of the query. This is used for resolving any relative URIs appearing
                  within the query, for example in references to library modules, schema
                  locations, or as an argument to the <code>doc()</code> function.
                  </p>
            </div><a name="CompileWithTracing"></a><div class="member">
               <h3>CompileWithTracing</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a>&nbsp;CompileWithTracing&nbsp;{get; set; }</div>
               <p>
                  Property indicating that the query is to be compiled with tracing enabled.
                  </p>
               
               <p>This allows tracing to be switched on at run-time, but it has no effect unless
                  run-time tracing is activated.</p>
               </div><a name="ContextItemType"></a><div class="member">
               <h3>ContextItemType</h3>
               <div class="code">public&nbsp;<a href="XdmItemType.html" class="apilink">XdmItemType</a>&nbsp;ContextItemType&nbsp;{get; set; }</div>
               <p>
                  The required context item type for the expression. This is used for
                  optimizing the expression at compile time, and to check at run-time
                  that the value supplied for the context item is the correct type.
                  </p>
            </div><a name="DefaultCollationName"></a><div class="member">
               <h3>DefaultCollationName</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;DefaultCollationName&nbsp;{get; set; }</div>
               <p>
                  The name of the default collation used by queries compiled using this <code>XQueryCompiler</code>.
                  This must be the name of a collation that is known to the <code>Processor</code>.
                  </p>
            </div><a name="ErrorReporter"></a><div class="member">
               <h3>ErrorReporter</h3>
               <div class="code">public&nbsp;<a href="ErrorReporter.html" class="apilink">ErrorReporter</a>&nbsp;ErrorReporter&nbsp;{get; set; }</div>
               <p>Set the <code>ErrorReporter</code> to be used when validating instance documents as a user defined IErrorReporter.
                  Requirements here is IErrorReport implementation with a user-written <code>report()</code> method, it is possible to
                  intercept error conditions as they occur.
                  If this property is used then the ErrorList property and SetErrorList method is overriden.</p>
               <p>The <code>IErrorReporter</code> to be used</p>
            </div><a name="FastCompilation"></a><div class="member">
               <h3>FastCompilation</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a>&nbsp;FastCompilation&nbsp;{get; set; }</div>
               <p>
                  Property indicating that fast compilation is preferred.
                  Fast compilation will generally be achieved at the expense of run-time performance
                  and quality of diagnostics. Fast compilation is a good trade-off if (a) the expression
                  is known to be correct,
                  and (b) once compiled, the expression is only executed once against a document of
                  modest size.
                  </p>
               
               <p>
                  <i>The current implementation is equivalent to switching off all optimizations. Setting
                     this option, however,
                     indicates an intent rather than a mechanism, and the implementation details may change
                     in future to reflect
                     the intent.</i>
                  </p>
               
               <p>Set to true to request fast compilation; set to false to revert to the optimization
                  options
                  defined in the Configuration.</p>
               </div><a name="Processor"></a><div class="member">
               <h3>Processor</h3>
               <div class="code">public&nbsp;<a href="Processor.html" class="apilink">Processor</a>&nbsp;Processor&nbsp;{get; }</div>
               <p>
                  Get the <code>Processor</code> from which this <code>XQueryCompiler</code> was constructed
                  </p>
            </div><a name="SchemaAware"></a><div class="member">
               <h3>SchemaAware</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a>&nbsp;SchemaAware&nbsp;{get; set; }</div>
               <p>
                  Property indicating that the query is to be compiled to be schema-aware, even if it
                  contains no
                  "import schema" declarations. Normally a query is treated as schema-aware
                  only if it contains one or more "import schema" declarations. 
                  </p>
               
               <p>If the query is not schema-aware, then all input documents must be untyped 
                  (or <code>xs:anyType</code>), and validation of temporary nodes is disallowed
                  (though validation of the final result tree is permitted). Setting the argument to
                  true
                  means that schema-aware code will be compiled regardless.</p>
               </div><a name="StreamingEnabled"></a><div class="member">
               <h3>StreamingEnabled</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a>&nbsp;StreamingEnabled&nbsp;{get; set; }</div>
               <p>
                  Property indicating that the query is to be compiled to enable streaming, which is
                  necessary if the query is to be executed using the method <code>XQueryEvaluator.RunStreamed()</code>.
                  In streaming mode, the source document is supplied as a stream, and no tree is built
                  in memory. The default is false.
                  </p>
               
               <p>When the value is set to <code>true</code>, this has the additional side-effect of
                  setting the required context item type to <code>document-node()</code>.</p>
               </div><a name="UpdatingEnabled"></a><div class="member">
               <h3>UpdatingEnabled</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.boolean(VS.80).aspx" class="apilink system" target="_blank">bool</a>&nbsp;UpdatingEnabled&nbsp;{get; set; }</div>
               <p>
                  This property indicates whether XQuery Update syntax is accepted. The default
                  value is false. This property must be set to true before compiling a query that
                  uses update syntax.
                  </p>
               
               <p>This property must be set to true before any query can be compiled
                  that uses updating syntax. This applies even if the query is not actually an updating
                  query (for example, a copy-modify expression). XQuery Update syntax is accepted
                  only by Saxon-EE. Non-updating queries are accepted regardless of the value of this
                  property.</p>
               </div><a name="XQueryLanguageVersion"></a><div class="member">
               <h3>XQueryLanguageVersion</h3>
               <div class="code">public&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;XQueryLanguageVersion&nbsp;{get; set; }</div>
               <p>
                  This property indicates which version of XQuery language syntax is accepted. The values
                  accepted are "3.1" and "4.0". The default is "3.1".
                  </p>
               
               <p>XQuery 4.0 is work in progress, and the specification is far from stable.</p>
               </div><a name="XQueryResolver"></a><div class="member">
               <h3>XQueryResolver</h3>
               <div class="code">public&nbsp;<a href="XQueryResolver.html" class="apilink">XQueryResolver</a>&nbsp;XQueryResolver&nbsp;{get; set; }</div>
               <p>
                  A user-supplied <code>XQueryResolver</code> used to resolve the URIs appearing in an
                  <code>import module</code> declaration.
                  </p>
               
               <p>If an <code>import module</code> declaration identifies a module URI that has already been loaded,
                  then the existing module is used (regardless of location hints and regardless of the
                  <code>XQueryResolver</code>),
                  unless the configuration option <code>XQUERY_MULTIPLE_MODULE_IMPORTS</code> is set. If this option is set, then an existing
                  module will be reused if the location hint matches; otherwise a new module is loaded
                  (which can
                  potentially cause a failure if it results in duplicate variables or functions having
                  the same name).
                  </p>
               
               <p>The <code>XQueryResolver</code> can return multiple library modules; if it does so, they are all
                  imported. If it returns an empty array, nothing is imported.</p>
               
               <p>If the <code>XQueryResolver</code> returns null (as distinct from returning an empty array),
                  then the <code>import module</code> declaration is resolved as if there were no user-supplied
                  <code>XQueryResolver</code>.</p>
               
               <p>If there is no user-supplied <code>XQueryResolver</code>, and if the module has not already been
                  loaded, then an <code>import module</code> declaration is interpreted as follows. First, if there are no location hints,
                  then a static error is reported. Otherwise, each URI listed in the location hints
                  is
                  resolved using the default resolution algorithm for the <code>Processor</code>, and this is expected
                  to deliver an input stream containing an XQuery library module.</p>
               
               <p>The interface changed in Saxon 11.1 so that the <code>XQueryResolver</code> now returns one or more
                  <code>TextResource</code> objects. The previous class <code>XQueryModuleSource</code> no longer exists.
                  </p>
               </div>
         </div><a name="method_detail"></a><div class="section">
            <h2>Method Detail</h2><a name="Compile(Stream)"></a><div class="member">
               <h3>Compile</h3>
               <div class="fullsignature"><span class="fblock">public&nbsp;<a href="XQueryExecutable.html" class="apilink">XQueryExecutable</a>&nbsp;Compile</span><span class="fblock">(<a href="http://msdn.microsoft.com/en-us/library/system.io.stream(VS.80).aspx" class="apilink system" target="_blank">Stream</a>&nbsp;query)<br>throws<br><a href="SaxonApiException.html" class="apilink">SaxonApiException</a></span></div>
               <div class="fcomment">
                  <p>
                     Compile a query supplied as a <code>Stream</code>.
                     </p>
                  
                  <p>The XQuery processor attempts to deduce the encoding of the query
                     by looking for a byte-order-mark, or if none is present, by looking
                     for the encoding declaration in the XQuery version declaration.
                     For this to work, the stream must have the <code>CanSeek</code> property.
                     If no encoding information is present, UTF-8 is assumed.</p>
                  
                  <p>The base URI of the query is set to the value of the <code>BaseUri</code>
                     property. If this has not been set, then the base URI will be undefined, which
                     means that any use of an expression that depends on the base URI will cause
                     an error.</p>
                  
                  <p class="methodLabel">Parameters:</p>
                  <div class="params"><code>query</code>&nbsp;-&nbsp;A stream containing the source text of the query</div>
                  <p class="methodLabel">Returns:</p>
                  <div class="params">An <code>XQueryExecutable</code> which represents the compiled query object.
                     The <code>XQueryExecutable</code> may be run as many times as required, in the same or a different
                     thread. The <code>XQueryExecutable</code> is not affected by any changes made to the <code>XQueryCompiler</code>
                     once it has been compiled.</div>
                  <p class="methodLabel">Throws:</p>
                  <div class="params"><a href="SaxonApiException.html" class="apilink">SaxonApiException</a>&nbsp;-&nbsp;Throws a <code>SaxonApiException</code> if errors were detected
                     during static analysis of the query. Details of the errors will be reported to the
                     <code>ErrorReporter</code> if supplied; otherwise they will be written to the standard
                     error stream. The exception that is returned from this method is merely a summary
                     indicating the
                     status, and is not useful for diagnosing the actual error.</div>
                  <p class="methodLabel">Example:</p><samp>
                     XQueryExecutable q = compiler.Compile(new FileStream("input.xq", FileMode.Open, FileAccess.Read));
                     </samp></div>
            </div><a name="Compile(string)"></a><div class="member">
               <h3>Compile</h3>
               <div class="fullsignature"><span class="fblock">public&nbsp;<a href="XQueryExecutable.html" class="apilink">XQueryExecutable</a>&nbsp;Compile</span><span class="fblock">(<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;query)<br>throws<br><a href="SaxonApiException.html" class="apilink">SaxonApiException</a></span></div>
               <div class="fcomment">
                  <p>
                     Compile a query supplied as a <code>string</code>.
                     </p>
                  <p>
                     Using this method the query processor is provided with a string of Unicode
                     characters, so no decoding is necessary. Any encoding information present in the
                     version declaration is therefore ignored.
                     </p>
                  <p class="methodLabel">Parameters:</p>
                  <div class="params"><code>query</code>&nbsp;-&nbsp;A string containing the source text of the query</div>
                  <p class="methodLabel">Returns:</p>
                  <div class="params">An <code>XQueryExecutable</code> which represents the compiled query object.
                     The <code>XQueryExecutable</code> may be run as many times as required, in the same or a different
                     thread. The <code>XQueryExecutable</code> is not affected by any changes made to the <code>XQueryCompiler</code>
                     once it has been compiled.</div>
                  <p class="methodLabel">Throws:</p>
                  <div class="params"><a href="SaxonApiException.html" class="apilink">SaxonApiException</a>&nbsp;-&nbsp;Throws a <code>SaxonApiException</code> if errors were detected
                     during static analysis of the query. Details of the errors will be reported to the
                     <code>ErrorReporter</code> if supplied; otherwise they will be written to the standard
                     error stream. The exception that is returned from this method is merely a summary
                     indicating the
                     status, and is not useful for diagnosing the actual error.</div>
                  <p class="methodLabel">Example:</p><samp>
                     XQueryExecutable q = compiler.Compile("distinct-values(//*/node-name()");
                     </samp></div>
            </div><a name="CompileLibrary(Stream)"></a><div class="member">
               <h3>CompileLibrary</h3>
               <div class="fullsignature"><span class="fblock">public&nbsp;void&nbsp;CompileLibrary</span><span class="fblock">(<a href="http://msdn.microsoft.com/en-us/library/system.io.stream(VS.80).aspx" class="apilink system" target="_blank">Stream</a>&nbsp;query)<br>throws<br></span></div>
               <div class="fcomment">
                  <p>
                     Compile a library module supplied as a stream. The code generated by compiling the
                     library is available
                     for importing by all subsequent compilations using the same XQueryCompiler; it is
                     identified by an
                     "import module" declaration that specifies the module URI of the library module. No
                     module location
                     hint is required, and if one is present, it is ignored.
                     </p>
                  
                  <p>The base URI of the query should be supplied by setting the <code>BaseURI</code>
                     property of the <code>QueryCompiler</code>.</p>
                  
                  <p class="methodLabel">Parameters:</p>
                  <div class="params"><code>query</code>&nbsp;-&nbsp;A stream delivering the text of the query</div>
                  <p class="methodLabel">Throws:</p>
                  <div class="params">&nbsp;-&nbsp;SaxonApiException if the query compilation fails with a static error</div>
               </div>
            </div><a name="CompileLibrary(string)"></a><div class="member">
               <h3>CompileLibrary</h3>
               <div class="fullsignature"><span class="fblock">public&nbsp;void&nbsp;CompileLibrary</span><span class="fblock">(<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;query)<br>throws<br></span></div>
               <div class="fcomment">
                  <p>
                     Compile a library module supplied as a string. The code generated by compiling the
                     library is available
                     for importing by all subsequent compilations using the same XQueryCompiler; it is
                     identified by an
                     "import module" declaration that specifies the module URI of the library module. No
                     module location
                     hint is required, and if one is present, it is ignored.
                     </p>
                  
                  <p>The base URI of the query should be supplied by setting the <code>BaseURI</code>
                     property of the <code>QueryCompiler</code>.</p>
                  
                  <p class="methodLabel">Parameters:</p>
                  <div class="params"><code>query</code>&nbsp;-&nbsp;The text of the query</div>
                  <p class="methodLabel">Throws:</p>
                  <div class="params">&nbsp;-&nbsp;SaxonApiException if the query compilation fails with a static error</div>
               </div>
            </div><a name="DeclareNamespace(string,string)"></a><div class="member">
               <h3>DeclareNamespace</h3>
               <div class="fullsignature"><span class="fblock">public&nbsp;void&nbsp;DeclareNamespace</span><span class="fblock">(<a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;prefix, <br><a href="http://msdn.microsoft.com/en-us/library/system.string(VS.80).aspx" class="apilink system" target="_blank">string</a>&nbsp;uri)</span></div>
               <div class="fcomment">
                  <p>
                     Declare a namespace for use by the query. This has the same
                     status as a namespace declaration appearing within the query prolog (though
                     a declaration of the same prefix in the query prolog will take
                     precedence).
                     </p>
                  <p class="methodLabel">Parameters:</p>
                  <div class="params"><code>prefix</code>&nbsp;-&nbsp;The namespace prefix to be declared. Use
                     a zero-length string to declare the default namespace (that is, the
                     default namespace for elements and types).</div>
                  <div class="params"><code>uri</code>&nbsp;-&nbsp;The namespace URI. It is possible to specify
                     a zero-length string to "undeclare" a namespace.</div>
               </div>
            </div>
         </div>
         <p>&nbsp;</p>
      </div>
      <div class="margin">
         &nbsp;
         </div>
   </body>
</html>